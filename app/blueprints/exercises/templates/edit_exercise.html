{% extends "base.html" %}
{% from "macros.html" import form_section, input_field, select_field %}

{% block title %}Edit Exercise - {{ exercise.name }}{% endblock %}

{% block content %}
{% call form_section(
    'Edit Exercise',
    submit_label='Update Exercise',
    cancel_url=url_for('exercises.wt_exercises', competition_id=exercise.competition_id),
    show_flash=true
) %}
    <p class="text-muted mb-4">{{ exercise.name }}</p>
    
    {{ input_field('name', 'Exercise Name', value=exercise.name, required=true) }}
    {{ input_field('max_points', 'Max Points', type='number', value=exercise.max_points, min=1) }}
    
    {% set judge_options = [] %}
    {% for user in users %}
        {% if user.role in ['admin', 'organizer', 'judge'] %}
            {% set _ = judge_options.append((user.id, user.username + ' (' + user.role + ')')) %}
        {% endif %}
    {% endfor %}
    {{ select_field('judge_id', 'Judge', judge_options, selected=exercise.judge_id, empty_option='-- No judge --') }}
    
    {% set helper_options = [] %}
    {% for user in users %}
        {% if user.role in ['admin', 'organizer', 'helper'] %}
            {% set _ = helper_options.append((user.id, user.username + ' (' + user.role + ')')) %}
        {% endif %}
    {% endfor %}
    {{ select_field('helper_id', 'Helper', helper_options, selected=exercise.helper_id, empty_option='-- No helper --') }}
{% endcall %}
{% endblock %}
